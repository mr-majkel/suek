---
title: "Analiza Rascha dla testu matematycznego TOS6"
author: "Michał Modzelewski"
date: "Wednesday, December 03, 2014"
output: html_document
---
``` {r include = FALSE, cache = TRUE}
setwd(paste0("C:\\Users\\Uzytkownik\\Documents\\SUEK\\",
             "Projects\\suek\\testy osiagniec\\TOS 6\\mat"))
wd = getwd()

options("stringsAsFactors" = FALSE)

library(TAM)
library(sirt)
library(mirt)
library(WrightMap)
library(xtable)
library(plyr)

source("skrypty\\pomocnicze\\difWang.R")
source("skrypty\\pomocnicze\\anchor.R")
```
# O teście

Test umiejętności matematycznych TOS6 składa się z dwóch wersji (A i B), po 25 zadań każda. Część zadań, tzw. zadania kotwiczące, jest taka sama dla obu wersji. Poniżej znajduje się tabela informująca o tym, które zadania w wersji A odpowiadają zadaniom w wersji B.
```{r include = FALSE}
# kotwiczące
kotw = matrix(c("MA_4", "MB_4",
                "MA_6", "MB_6",
                "MA_8", "MB_7",
                "MA_9", "MB_8",
                "MA_10", "MB_9",
                "MA_12", "MB_12",
                "MA_13", "MB_13",
                "MA_14", "MB_14",
                "MA_15", "MB_16",
                "MA_16", "MB_17",
                "MA_18", "MB_18",
                "MA_22", "MB_22",
                "MA_23", "MB_23",
                "MA_24", "MB_24"), ncol = 2, byrow = TRUE)

colnames(kotw) = c("wersja A", "wersja B")
```

``` {r results='asis', echo = FALSE}
# print(xtable(kotw, "Tabela 1. Zadania kotwiczące w podziale na wersje.",
#              align = "ccc"),
#       type = "html", include.rownames = FALSE)
knitr::kable(kotw, row.names = FALSE,
      caption = "Zadania kotwiczące w podziale na wersje")
```

# Wczytanie i obróbka danych

Poniżej znajduje się informacja o wczytanych danych.
``` {r, cache = TRUE}
# wczytanie baz
setwd(paste0("C:\\Users\\Uzytkownik\\Documents\\SUEK\\",
             "Projects\\suek\\testy osiagniec\\TOS 6\\mat"))
mat_all = read.csv2("bazy zmien\\tos6_mat.csv") # dane surowe
mat_all_r = read.csv2("bazy zmien\\tos6_mat_rek.csv") # dane rekodowane
ucz_df = read.csv2("bazy oryg\\uczen_dane.csv") # info o uczniach
```

Dodanie płci, id szkoły, oznaczenia oddziału w klasie VI i nru z dziennika do baz z wynikami.
``` {r}
mat_all = merge(mat_all, ucz_df, all.x = TRUE)
mat_all_r = merge(mat_all_r, ucz_df, all.x = TRUE)
```

Stworzenie zmiennych kotwiczących w bazach i skopiowanie dla nich odpowienich wartości.
```{r}
mat_all[, paste0("K", kotw[, 1])] = NA
mat_all_r[, paste0("K", kotw[, 1])] = NA

# skopiowanie wartości dla zmiennych kotwiczących
mat_all = anchor(mat_all, kotw)
mat_all_r = anchor(mat_all_r, kotw)
```

```{r}
# nazwy wszystkich itemów w bazie
items_all = grep("MA|MB", names(mat_all_r), value = TRUE)
```



